# –ü—Ä–æ–µ–∫—Ç–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ: ETL

## –ó–∞–¥–∞–Ω–∏–µ —Å–ø—Ä–∏–Ω—Ç–∞

–ù–∞–ø–∏—Å–∞—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–π –ø–µ—Ä–µ–Ω–æ—Å –¥–∞–Ω–Ω—ã—Ö –∏–∑ Postgres –≤ Elasticsearch

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—É—é [c—Ö–µ–º—É –∏–Ω–¥–µ–∫—Å–∞](https://code.s3.yandex.net/middle-python/learning-materials/es_schema.txt)üíæ  `movies`, –≤ –∫–æ—Ç–æ—Ä—É—é –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å—Å—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∏–ª—å–º–æ–≤. –í –∫–æ–Ω—Ü–µ —ç—Ç–æ–≥–æ —É—Ä–æ–∫–∞ –≤—ã –Ω–∞–π–¥—ë—Ç–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è –∫ –Ω–µ–π.
- –í–∞—à –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –≤–µ—Å—Ç–∏ —Å–µ–±—è –ø—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Å–≤—è–∑–∏ —Å ES –∏–ª–∏ Postgres. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Ö–Ω–∏–∫—É backoff, —á—Ç–æ–±—ã –≤–∞—à —Å–µ—Ä–≤–∏—Å –Ω–µ –º–µ—à–∞–ª –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—é –ë–î.
- –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ–Ω–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å –º–µ—Å—Ç–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏, –∞ –Ω–µ –Ω–∞—á–∏–Ω–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–æ–≤–æ. –ó–¥–µ—Å—å –≤–∞–º –ø–æ–º–æ–∂–µ—Ç —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
- ES —Å –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—Ö–æ–¥–∏—Ç [Postman-—Ç–µ—Å—Ç—ã](https://code.s3.yandex.net/middle-python/learning-materials/ETLTests-2.json)üíæ. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º —Å–ø–æ—Å–æ–±–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º—ã —Ä–∞—Å—Å–∫–∞–∂–µ–º –≤ —Å–ª–µ–¥—É—é—â–µ–º —É—Ä–æ–∫–µ.

----

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–µ—Ä–≤–∏—Å–∞:

—Å–µ—Ä–≤–∏—Å —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</br>
|—ç–ª–µ–º–µ–Ω—Ç|–æ–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|db|–ø–æ—Å—Ç–≥—Ä–µ—Å –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö(–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è, –±—ç–∫–∞–ø)|
|app|–¥–∂–∞–Ω–≥–æ –∞–¥–º–∏–Ω–∫–∞(–≥–æ–ª—ã–π –¥–∂–∞–Ω–≥–æ+–¥—Ä—Ñ)|
|nginx|–æ—Ç–¥–∞—á–∞ —Å—Ç–∞—Ç–∏–∫–∏|
|sqlite_to_postgres|–º–∏–≥—Ä–∞—Ü–∏—è –∏–∑ sqlite –≤ postgres|
|postgres_to_es|–º–∏–≥—Ä–∞—Ü–∏—è –∏–∑ postgres –≤ elasticsearch|

### —Å–æ—Å—Ç–∞–≤–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã _postgres_to_es_:

|—ç–ª–µ–º–µ–Ω—Ç|–æ–ø–∏—Å–∞–Ω–∏–µ|
|---|---|
|extract|–∏–∑–≤–ª–µ–∫–∞–µ—Ç –ø–∞—á–∫—É –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ø–æ—Å—Ç–≥—Ä–µ—Å–∞ (–∫–∏–Ω–æ–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è, –ø–µ—Ä—Å–æ–Ω—ã –≤ –∫–∏–Ω–æ–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏ –∏ –∂–∞–Ω—Ä—ã –≤ –∫–∏–Ω–æ–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–∏|
|transform|–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –∏–∑–≤–ª–µ—á–µ–Ω–Ω—ã–π –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç, –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π –º–∞–ø–ø–∏–Ω–≥–æ–º —ç–ª–∞—Å—Ç–∏–∫–∞|
|load|–∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —ç–ª–∞—Å—Ç–∏–∫|

–°–µ—Ä–≤–∏—Å —Å–ª–µ–¥–∏—Ç –∑–∞ —Å—Ç–∞—Ç—É—Å–æ–º —ç–ª–∞—Å—Ç–∏–∫–∞, —Ä–∞–±–æ—Ç–∞—è –≤ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —Ü–∏–∫–ª–µ

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é:
—Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:```docker compose -f docker-compose.dev.yaml up --build```


